<link rel="import" href="../../components/polymer/polymer.html">
<link rel="import" href="../../components/core-icons/core-icons.html">
<link rel="import" href="../../components/core-icons/iconsets/device-icons.html">
<link rel="import" href="../../components/paper-ripple/paper-ripple.html">
<link rel="import" href="../../components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../components/paper-button/paper-button.html">

<polymer-element name="indiv-post" attributes="score postid mark author timestamp">
	<template>
		<link rel="stylesheet" href="../../public/style.css" shim-shadowdom>
		<style>
			:host{
				display:block;
				/*padding: 22px 30px 20px 30px;*/
				border-bottom: 1px solid #ededed;
				cursor:pointer;
				position:relative;
				overflow:hidden;
				box-sizing:border-box;
				-webkit-perspective: 100px;
				perspective: 100px;
				-webkit-transform-origin:50% 0%;
				transform-origin:50% 0%;
			}
			.padding{
				padding: 25px 36px 25px 36px;
			}
			h1{
				color:#585858;
				text-decoration:none;
				letter-spacing: .3px;
				font-size: 18px;
				font-weight:300;
				line-height: 1.34;
			}
			.bodytext{
				background:black;
			}
			paper-ripple{
				position:absolute;
				top:0;
				bottom:0;
				left:0;
				right:0;
			}
			.social{
				padding-top: 15px;
			}
			.social span.number{
				letter-spacing: .9px;
				font-size:20px;
				font-weight:300;
				margin-right:12px;
				display: inline-block;
				color:#8a8a8a;
				vertical-align: middle;
			}
			.social paper-icon-button{
				position:relative;
				cursor:pointer;
				display: inline-block;
				vertical-align: middle;
				fill:#a9a9a9;
				transition:all .13s ease;
			}
			.social paper-icon-button .up{

			}
			.social paper-icon-button .down{

			}
			.social paper-icon-button:not([active]):hover{
				fill:#bcbcbc;
			}
			.social p.info{
				display:inline-block;
				vertical-align:middle;
				float:right;
				text-align:right;
				font-size:12px;
				margin-top: 5px;
				line-height:1.65;
				font-weight:300;
				letter-spacing:.3px;
				text-transform:uppercase;
				color:rgb(208, 208, 208);
			}
			.social .info .author{
				color:rgb(208, 208, 208);
				position:relative;
				text-decoration:none;
				cursor:pointer;
			}
			.social .author:hover span{
				text-decoration:underline;
			}
			.viewcomments{
				text-transform:none;
				font-size:18px;
				background:#fbfbfb;
				display:inline-block;
				vertical-align:middle;
				color: #929292;
				letter-spacing: .3px;
				font-weight: 400;
				opacity:.8;
				font-size:14px;
				margin-left:22px;
			}
		</style>
		<div class="padding">
			<a href="http://yahoo.com"><paper-ripple></paper-ripple></a>
			<div class="content">
				<h1>Meet Olga - The only cat I've met that likes to go on hikes</h1>
				<content select=".bodytext"></content>
			</div>
			<div class="social">
				<span class="number">{{score}}</span>
				<paper-icon-button active?="{{mark == 1}}" id="up" isToggle="true" on-tap="{{thumbsUp}}" icon="thumb-up"></paper-icon-button>
				<paper-icon-button active?="{{mark == -1}}" id="down" isToggle="true" on-tap="{{thumbsDown}}" icon="thumb-down"></paper-icon-button>
				<a href="/comments/{{postid}}"><paper-button class="viewcomments" label="View Comments"></paper-button></a>
				<p class="info">
					<a class="author" href="/user/{{author}}">Submitted by <span>{{author}}</span></a><br>
					<span id="ago" timestamp="{{timestamp}}"></span>
				</p>
			</div>
		</div>
	</template>
	<script>
		Polymer('indiv-post', {
			created: function(){
				
			},
			domReady: function(){
				var self = this;
				setInterval(function(){
					self.recheckTime();
				}, 20000);
				self.recheckTime();
			},
			recheckTime: function(){
				this.$.ago.innerHTML = timeago(moment.utc(parseInt(this.$.ago.getAttribute('timestamp'))));
			},
			thumbsUp: function(event, detail, sender) {
				if(!sender.active){
					this.score--;
				}else{
					var downButt = this.$.down;
					var downbuttActive = downButt.active;
					this.score = parseInt(this.score) + 1 + (downbuttActive ? 1 : 0);

					downButt.active = false;
				}
			},
			thumbsDown: function(event, detail, sender){
				if(!sender.active){
					this.score++;
				}else{
					var upButt = this.$.up;

					var upButtActive = upButt.active;
					this.score = parseInt(this.score) - 1 - (upButtActive ? 1 : 0);

					upButt.active = false;
				}
			}
		});
	</script>
</polymer-element>